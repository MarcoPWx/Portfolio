<!DOCTYPE html>
<html lang="en" data-theme="auto">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMPLETE DATA FLOW ARCHITECTURE</title>
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    
    <style>
    /* Light mode variables */
    :root {
      --primary: #007AFF;
      --primary-hover: #0051D5;
      --success: #34C759;
      --warning: #FF9500;
      --danger: #FF3B30;
      --text-primary: #000000;
      --text-secondary: #3C3C43;
      --text-tertiary: #8E8E93;
      --bg-primary: #FFFFFF;
      --bg-secondary: #F2F2F7;
      --bg-tertiary: #FFFFFF;
      --bg-elevated: #FFFFFF;
      --border: rgba(0, 0, 0, 0.1);
      --border-subtle: rgba(0, 0, 0, 0.04);
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.12);
      --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1), 0 4px 10px rgba(0, 0, 0, 0.08);
      --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.15);
      --backdrop: rgba(255, 255, 255, 0.8);
      --code-bg: #F7F7FA;
      --code-border: rgba(0, 0, 0, 0.06);
      --nav-bg: rgba(255, 255, 255, 0.72);
      --card-bg: #FFFFFF;
      --hover-bg: rgba(0, 122, 255, 0.08);
    }
    
    /* Dark mode variables */
    [data-theme="dark"] {
      --primary: #0A84FF;
      --primary-hover: #409CFF;
      --success: #32D74B;
      --warning: #FF9F0A;
      --danger: #FF453A;
      --text-primary: #FFFFFF;
      --text-secondary: #EBEBF5;
      --text-tertiary: #8E8E93;
      --bg-primary: #000000;
      --bg-secondary: #1C1C1E;
      --bg-tertiary: #2C2C2E;
      --bg-elevated: #1C1C1E;
      --border: rgba(255, 255, 255, 0.15);
      --border-subtle: rgba(255, 255, 255, 0.06);
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.4);
      --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3);
      --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.5), 0 4px 10px rgba(0, 0, 0, 0.4);
      --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.6);
      --backdrop: rgba(28, 28, 30, 0.8);
      --code-bg: #1C1C1E;
      --code-border: rgba(255, 255, 255, 0.08);
      --nav-bg: rgba(28, 28, 30, 0.72);
      --card-bg: #1C1C1E;
      --hover-bg: rgba(10, 132, 255, 0.15);
    }
    
    /* Auto theme based on system preference */
    @media (prefers-color-scheme: dark) {
      :root:not([data-theme="light"]) {
        --primary: #0A84FF;
        --primary-hover: #409CFF;
        --success: #32D74B;
        --warning: #FF9F0A;
        --danger: #FF453A;
        --text-primary: #FFFFFF;
        --text-secondary: #EBEBF5;
        --text-tertiary: #8E8E93;
        --bg-primary: #000000;
        --bg-secondary: #1C1C1E;
        --bg-tertiary: #2C2C2E;
        --bg-elevated: #1C1C1E;
        --border: rgba(255, 255, 255, 0.15);
        --border-subtle: rgba(255, 255, 255, 0.06);
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.4);
        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3);
        --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.5), 0 4px 10px rgba(0, 0, 0, 0.4);
        --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.6);
        --backdrop: rgba(28, 28, 30, 0.8);
        --code-bg: #1C1C1E;
        --code-border: rgba(255, 255, 255, 0.08);
        --nav-bg: rgba(28, 28, 30, 0.72);
        --card-bg: #1C1C1E;
        --hover-bg: rgba(10, 132, 255, 0.15);
      }
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html {
      scroll-behavior: smooth;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
      font-size: 17px;
      line-height: 1.6;
      color: var(--text-primary);
      background: var(--bg-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px;
    }
    
    /* Typography */
    p {
      margin: 1.2rem 0;
      color: var(--text-secondary);
      letter-spacing: -0.011em;
    }
    
    a {
      color: var(--primary);
      text-decoration: none;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 2px;
    }
    
    a:hover {
      color: var(--primary-hover);
      text-decoration: none;
    }
    
    a:focus {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }
    
    /* Headings */
    h1, h2, h3, h4, h5, h6 {
      font-weight: 600;
      line-height: 1.2;
      margin-top: 2.5rem;
      margin-bottom: 1rem;
      letter-spacing: -0.02em;
      color: var(--text-primary);
    }
    
    h1 {
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-hover) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-top: 0;
      margin-bottom: 1.5rem;
    }
    
    h2 {
      font-size: 2rem;
      font-weight: 600;
      color: var(--text-primary);
      border-bottom: 1px solid var(--border-subtle);
      padding-bottom: 0.75rem;
      margin-top: 3rem;
    }
    
    h3 {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-primary);
    }
    
    h4 {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-secondary);
    }
    
    /* Lists */
    ul, ol {
      padding-left: 2rem;
      margin: 1.5rem 0;
      color: var(--text-secondary);
    }
    
    li {
      margin: 0.75rem 0;
      line-height: 1.6;
    }
    
    /* Strong text */
    strong, b {
      font-weight: 600;
      color: var(--text-primary);
    }
    
    /* Navigation */
    .nav-wrapper {
      position: sticky;
      top: 0;
      z-index: 100;
      background: var(--nav-bg);
      backdrop-filter: saturate(180%) blur(20px);
      -webkit-backdrop-filter: saturate(180%) blur(20px);
      border-bottom: 1px solid var(--border);
      margin-bottom: 2rem;
    }
    
    nav {
      padding: 1rem 0;
    }
    
    .nav-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    
    nav li {
      margin: 0;
    }
    
    nav a {
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: 500;
      font-size: 0.95rem;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    nav a:hover {
      background: var(--hover-bg);
      color: var(--primary);
    }
    
    nav a:focus {
      outline: none;
    }
    
    /* Theme Switcher */
    .theme-switcher {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.375rem;
      background: var(--bg-secondary);
      border-radius: 10px;
      border: 1px solid var(--border-subtle);
    }
    
    .theme-btn {
      padding: 0.375rem 0.625rem;
      background: transparent;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      color: var(--text-tertiary);
      font-size: 0.875rem;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .theme-btn:hover {
      color: var(--text-secondary);
    }
    
    .theme-btn.active {
      background: var(--card-bg);
      color: var(--text-primary);
      box-shadow: var(--shadow-sm);
    }
    
    /* Code blocks */
    pre {
      background: var(--code-bg);
      padding: 1.5rem;
      border-radius: 12px;
      overflow-x: auto;
      border: 1px solid var(--code-border);
      margin: 2rem 0;
      font-size: 0.875rem;
      box-shadow: var(--shadow-sm);
    }
    
    code {
      font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
      background: var(--code-bg);
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-size: 0.875em;
      border: 1px solid var(--code-border);
    }
    
    pre code {
      background: none;
      padding: 0;
      border: none;
      font-size: 0.875rem;
    }
    
    /* Tables */
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin: 2rem 0;
      font-size: 0.95rem;
      background: var(--card-bg);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow-md);
    }
    
    th, td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-subtle);
    }
    
    th {
      background: var(--bg-secondary);
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--text-secondary);
    }
    
    td {
      color: var(--text-secondary);
    }
    
    tr:last-child td {
      border-bottom: none;
    }
    
    tr:hover {
      background: var(--hover-bg);
    }
    
    /* Blockquotes */
    blockquote {
      margin: 2rem 0;
      padding: 1.25rem;
      border-left: 4px solid var(--primary);
      background: var(--bg-secondary);
      border-radius: 0 12px 12px 0;
      color: var(--text-secondary);
      font-style: normal;
    }
    
    blockquote p {
      margin: 0.5rem 0;
    }
    
    /* Horizontal rules */
    hr {
      border: none;
      height: 1px;
      background: var(--border);
      margin: 3rem 0;
    }
    
    /* Cards */
    .card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1rem 0;
      box-shadow: var(--shadow-sm);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .card:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-2px);
    }
    
    /* Main content */
    main {
      min-height: calc(100vh - 200px);
      padding: 2rem 0;
    }
    
    /* Footer */
    footer {
      margin-top: 4rem;
      padding: 2rem 0;
      border-top: 1px solid var(--border);
      color: var(--text-tertiary);
      font-size: 0.875rem;
      text-align: center;
    }
    
    /* Grid for cards */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      h1 { font-size: 2.5rem; }
      h2 { font-size: 1.75rem; }
      h3 { font-size: 1.375rem; }
      
      .nav-content {
        flex-direction: column;
        gap: 1rem;
      }
      
      nav ul {
        flex-wrap: wrap;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="nav-wrapper">
    <div class="container">
      <nav class="nav-content">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/architecture/">Architecture</a></li>
          <li><a href="/all-docs/">All Docs</a></li>
          <li><a href="/learning-roadmap/">Learning Roadmaps</a></li>
          <li><a href="/devmentor/">DevMentor</a></li>
          <li><a href="/quizmentor/">QuizMentor</a></li>
          <li><a href="/harvest/">Harvest.ai</a></li>
          <li><a href="/naturequest-auth/">Auth</a></li>
          <li><a href="/infrastructure/">Infrastructure</a></li>
        </ul>
        <div class="theme-switcher" aria-label="Theme Switcher">
          <button class="theme-btn" data-theme="light" aria-pressed="false" title="Light mode">🌞 Light</button>
          <button class="theme-btn active" data-theme="auto" aria-pressed="true" title="Auto mode">🧭 Auto</button>
          <button class="theme-btn" data-theme="dark" aria-pressed="false" title="Dark mode">🌙 Dark</button>
        </div>
      </nav>
    </div>
  </div>

  <main class="container">
    <div class="product-header" style="background: #f6f8fa; padding: 1rem; border-radius: 5px; margin-bottom: 2rem;">
  <span style="color: #666;">DevMentor</span> / 
  <span style="color: #999;">architecture/COMPLETE_DATA_FLOW_ARCHITECTURE.md</span>
</div>

<h1>COMPLETE DATA FLOW ARCHITECTURE</h1>


<h1 id="devmentor-system-architecture--data-flow-guide">DevMentor System Architecture &amp; Data Flow Guide</h1>

<p><strong>Complete Understanding of How Everything Works Together</strong></p>

<hr />

<h2 id="-executive-summary">🎯 Executive Summary</h2>

<p>DevMentor is a <strong>microservices-based AI development platform</strong> that uses:</p>
<ul>
  <li><strong>Multiple specialized databases</strong> for different data types</li>
  <li><strong>Event-driven architecture</strong> for real-time updates</li>
  <li><strong>AI-powered intelligence</strong> throughout the system</li>
  <li><strong>Sophisticated caching</strong> and optimization strategies</li>
</ul>

<p>Let me break down exactly how data flows through the system and why each component exists.</p>

<hr />

<h2 id="️-core-architecture-overview">🏗️ Core Architecture Overview</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌─────────────────────────────────────────────────────────────────┐
│                         FRONTEND LAYER                           │
│  Next.js UI (Port 3000) → WebSocket Client → Redux Store        │
└────────────┬───────────────────────────────────┬─────────────────┘
             │                                   │
             ▼                                   ▼
┌──────────────────────┐            ┌──────────────────────┐
│   API Gateway        │            │  WebSocket Gateway    │
│   (Port 8080)        │            │  (Port 8081)          │
│   - Routing          │            │  - Real-time updates  │
│   - Auth             │            │  - Event broadcasting │
│   - Rate Limiting    │            │  - Room management    │
└──────────┬───────────┘            └──────────┬───────────┘
           │                                    │
           ▼                                    ▼
┌────────────────────────────────────────────────────────────┐
│                    MICROSERVICES LAYER                      │
├──────────────────┬──────────────────┬──────────────────────┤
│  Auth Service    │  AI Gateway      │  Memory Service      │
│  (Port 3002)     │  (Port 3001)     │  (Port 3003)         │
│  - JWT           │  - LLM routing   │  - RAG engine        │
│  - OAuth         │  - Prompt mgmt   │  - Vector storage    │
├──────────────────┼──────────────────┼──────────────────────┤
│  Project Service │  Learning Engine │  Platform Service    │
│  (Port 3004)     │  (Port 8005)     │  (Port 4003)         │
│  - Tasks/Epics   │  - Quiz gen      │  - Orchestration    │
│  - Sprints       │  - XP tracking   │  - Service mesh     │
└──────────────────┴──────────────────┴──────────────────────┘
           │                                    │
           ▼                                    ▼
┌────────────────────────────────────────────────────────────┐
│                      DATA LAYER                             │
├──────────────────┬──────────────────┬──────────────────────┤
│  PostgreSQL      │  Qdrant          │  Redis               │
│  - User data     │  - Vectors       │  - Cache             │
│  - Projects      │  - Embeddings    │  - Sessions          │
│  - Tasks         │  - Semantic      │  - Real-time         │
└──────────────────┴──────────────────┴──────────────────────┘
</code></pre></div></div>

<hr />

<h2 id="-data-storage-strategy">📊 Data Storage Strategy</h2>

<h3 id="1-postgresql-relational-data"><strong>1. PostgreSQL (Relational Data)</strong></h3>
<p><strong>Purpose</strong>: Structured, transactional data with ACID guarantees</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Primary storage for:</span>
<span class="o">-</span> <span class="n">Users</span> <span class="o">&amp;</span> <span class="n">Authentication</span>
<span class="o">-</span> <span class="n">Projects</span><span class="p">,</span> <span class="n">Epics</span><span class="p">,</span> <span class="n">Tasks</span><span class="p">,</span> <span class="n">Sprints</span>
<span class="o">-</span> <span class="n">Team</span> <span class="n">memberships</span> <span class="o">&amp;</span> <span class="n">permissions</span>
<span class="o">-</span> <span class="n">Audit</span> <span class="n">logs</span> <span class="o">&amp;</span> <span class="n">compliance</span> <span class="k">data</span>
<span class="o">-</span> <span class="n">Learning</span> <span class="n">progress</span> <span class="o">&amp;</span> <span class="n">achievements</span>
</code></pre></div></div>

<p><strong>Why PostgreSQL?</strong></p>
<ul>
  <li>Strong consistency for critical business data</li>
  <li>Complex relationships (users→projects→tasks)</li>
  <li>ACID transactions for data integrity</li>
  <li>Rich querying capabilities with SQL</li>
</ul>

<h3 id="2-qdrant-vector-database"><strong>2. Qdrant (Vector Database)</strong></h3>
<p><strong>Purpose</strong>: AI memory and semantic search</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Stores:
</span><span class="o">-</span> <span class="n">Text</span> <span class="n">embeddings</span> <span class="k">from</span> <span class="n">OpenAI</span>
<span class="o">-</span> <span class="n">Code</span> <span class="n">pattern</span> <span class="n">vectors</span>
<span class="o">-</span> <span class="n">User</span> <span class="n">behavior</span> <span class="n">embeddings</span>
<span class="o">-</span> <span class="n">Knowledge</span> <span class="n">base</span> <span class="n">vectors</span>
<span class="o">-</span> <span class="n">Semantic</span> <span class="n">search</span> <span class="n">indices</span>
</code></pre></div></div>

<p><strong>Why Qdrant?</strong></p>
<ul>
  <li>Optimized for vector similarity search</li>
  <li>Scales to millions of embeddings</li>
  <li>Fast nearest-neighbor queries (&lt;50ms)</li>
  <li>Critical for RAG (Retrieval Augmented Generation)</li>
</ul>

<h3 id="3-redis-cache--real-time"><strong>3. Redis (Cache &amp; Real-time)</strong></h3>
<p><strong>Purpose</strong>: High-speed caching and pub/sub</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Used for:</span>
<span class="o">-</span> <span class="nx">Session</span> <span class="nx">storage</span>
<span class="o">-</span> <span class="nx">API</span> <span class="nx">response</span> <span class="nx">caching</span>
<span class="o">-</span> <span class="nx">WebSocket</span> <span class="nx">room</span> <span class="nx">management</span>
<span class="o">-</span> <span class="nx">Real</span><span class="o">-</span><span class="nx">time</span> <span class="nx">event</span> <span class="nx">broadcasting</span>
<span class="o">-</span> <span class="nx">Rate</span> <span class="nx">limiting</span> <span class="nx">counters</span>
<span class="o">-</span> <span class="nx">Temporary</span> <span class="nx">data</span> <span class="o">&amp;</span> <span class="nx">queues</span>
</code></pre></div></div>

<p><strong>Why Redis?</strong></p>
<ul>
  <li>Sub-millisecond latency</li>
  <li>Pub/sub for real-time events</li>
  <li>TTL-based cache expiration</li>
  <li>Distributed locking</li>
</ul>

<hr />

<h2 id="-complete-data-flow-examples">🔄 Complete Data Flow Examples</h2>

<h3 id="example-1-creating-a-task-with-ai-assistance"><strong>Example 1: Creating a Task with AI Assistance</strong></h3>

<pre><code class="language-mermaid">sequenceDiagram
    participant User
    participant Frontend
    participant APIGateway
    participant AIGateway
    participant MemoryService
    participant ProjectService
    participant PostgreSQL
    participant Qdrant
    participant Redis
    participant WebSocket

    User-&gt;&gt;Frontend: Types "Create auth task"
    Frontend-&gt;&gt;APIGateway: POST /api/ai/assist
    APIGateway-&gt;&gt;AIGateway: Route request
    
    AIGateway-&gt;&gt;MemoryService: Search context
    MemoryService-&gt;&gt;Qdrant: Vector similarity search
    Qdrant--&gt;&gt;MemoryService: Related memories
    MemoryService--&gt;&gt;AIGateway: Context
    
    AIGateway-&gt;&gt;AIGateway: Generate task details (OpenAI)
    AIGateway--&gt;&gt;Frontend: Task suggestion
    
    User-&gt;&gt;Frontend: Confirms task
    Frontend-&gt;&gt;APIGateway: POST /api/projects/:id/tasks
    APIGateway-&gt;&gt;ProjectService: Create task
    
    ProjectService-&gt;&gt;PostgreSQL: INSERT task
    ProjectService-&gt;&gt;Redis: Invalidate cache
    ProjectService-&gt;&gt;WebSocket: Broadcast update
    
    WebSocket-&gt;&gt;Frontend: Real-time update
    Frontend-&gt;&gt;Frontend: Update UI
</code></pre>

<h3 id="example-2-memory-bank-learning-flow"><strong>Example 2: Memory Bank Learning Flow</strong></h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. User writes code</span>
<span class="kd">const</span> <span class="nx">userCode</span> <span class="o">=</span> <span class="s2">`
  const authenticate = async (user) =&gt; {
    // Implementation
  }
`</span><span class="p">;</span>

<span class="c1">// 2. Frontend sends to Memory Service</span>
<span class="nx">POST</span> <span class="o">/</span><span class="nx">api</span><span class="o">/</span><span class="nx">memory</span><span class="o">/</span><span class="nx">store</span>
<span class="p">{</span>
  <span class="nl">content</span><span class="p">:</span> <span class="nx">userCode</span><span class="p">,</span>
  <span class="nx">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">code_pattern</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">metadata</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">language</span><span class="p">:</span> <span class="dl">"</span><span class="s2">javascript</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">pattern</span><span class="p">:</span> <span class="dl">"</span><span class="s2">authentication</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">project</span><span class="p">:</span> <span class="dl">"</span><span class="s2">devmentor</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 3. Memory Service processes</span>
<span class="o">-</span> <span class="nx">Generates</span> <span class="nx">embedding</span> <span class="nx">via</span> <span class="nx">OpenAI</span>
<span class="o">-</span> <span class="nx">Stores</span> <span class="nx">vector</span> <span class="k">in</span> <span class="nx">Qdrant</span>
<span class="o">-</span> <span class="nx">Indexes</span> <span class="nx">metadata</span>
<span class="o">-</span> <span class="nx">Updates</span> <span class="nx">user</span> <span class="nx">profile</span>

<span class="c1">// 4. Later retrieval</span>
<span class="nx">GET</span> <span class="o">/</span><span class="nx">api</span><span class="o">/</span><span class="nx">memory</span><span class="o">/</span><span class="nx">search</span><span class="p">?</span><span class="nx">q</span><span class="o">=</span><span class="nx">authentication</span>
<span class="o">-</span> <span class="nx">Converts</span> <span class="nx">query</span> <span class="nx">to</span> <span class="nx">vector</span>
<span class="o">-</span> <span class="nx">Searches</span> <span class="nx">Qdrant</span> <span class="p">(</span><span class="nx">cosine</span> <span class="nx">similarity</span><span class="p">)</span>
<span class="o">-</span> <span class="nx">Returns</span> <span class="nx">relevant</span> <span class="nx">memories</span>
<span class="o">-</span> <span class="nx">AI</span> <span class="nx">uses</span> <span class="nx">context</span> <span class="k">for</span> <span class="nx">assistance</span>
</code></pre></div></div>

<hr />

<h2 id="-service-by-service-deep-dive">🧠 Service-by-Service Deep Dive</h2>

<h3 id="1-memory-service-port-3003"><strong>1. Memory Service (Port 3003)</strong></h3>
<p><strong>Core Technology</strong>: DevMentorAI RAG Engine + Qdrant</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// What it does:</span>
<span class="o">-</span> <span class="nx">Stores</span> <span class="nx">all</span> <span class="nx">user</span> <span class="nx">interactions</span> <span class="k">as</span> <span class="nx">vectors</span>
<span class="o">-</span> <span class="nx">Provides</span> <span class="nx">semantic</span> <span class="nx">search</span> <span class="nx">across</span> <span class="nx">memories</span>
<span class="o">-</span> <span class="nx">Powers</span> <span class="nx">context</span><span class="o">-</span><span class="nx">aware</span> <span class="nx">AI</span> <span class="nx">responses</span>
<span class="o">-</span> <span class="nx">Implements</span> <span class="nx">guardrails</span> <span class="p">(</span><span class="nx">PII</span> <span class="nx">detection</span><span class="p">,</span> <span class="nx">content</span> <span class="nx">filtering</span><span class="p">)</span>

<span class="c1">// Data flow:</span>
<span class="nx">User</span> <span class="nx">Input</span> <span class="err">→</span> <span class="nx">OpenAI</span> <span class="nx">Embedding</span> <span class="err">→</span> <span class="nx">Qdrant</span> <span class="nx">Storage</span> <span class="err">→</span> <span class="nx">Vector</span> <span class="nx">Index</span>
<span class="nx">Query</span> <span class="err">→</span> <span class="nx">Vector</span> <span class="nx">Search</span> <span class="err">→</span> <span class="nx">Context</span> <span class="nx">Retrieval</span> <span class="err">→</span> <span class="nx">AI</span> <span class="nx">Response</span>
</code></pre></div></div>

<p><strong>Key Features:</strong></p>
<ul>
  <li><strong>RAG (Retrieval Augmented Generation)</strong>: Combines retrieval with generation</li>
  <li><strong>Semantic Search</strong>: Find by meaning, not keywords</li>
  <li><strong>Context Windows</strong>: Manages 8000 token contexts</li>
  <li><strong>Safety</strong>: PII detection, content moderation</li>
</ul>

<h3 id="2-learning-engine-port-8005"><strong>2. Learning Engine (Port 8005)</strong></h3>
<p><strong>Purpose</strong>: Educational content and progress tracking</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Components:</span>
<span class="mi">1</span><span class="p">.</span> <span class="nx">Quiz</span> <span class="nx">Generator</span>
   <span class="o">-</span> <span class="nx">Dynamic</span> <span class="nx">quiz</span> <span class="nx">creation</span>
   <span class="o">-</span> <span class="nx">Multiple</span> <span class="nx">difficulty</span> <span class="nx">levels</span>
   <span class="o">-</span> <span class="nx">Progress</span> <span class="nx">tracking</span>

<span class="mi">2</span><span class="p">.</span> <span class="nx">XP</span> <span class="nx">Calculator</span>
   <span class="o">-</span> <span class="nx">Task</span> <span class="nx">completion</span> <span class="nx">points</span>
   <span class="o">-</span> <span class="nx">Skill</span> <span class="nx">progression</span>
   <span class="o">-</span> <span class="nx">Achievement</span> <span class="nx">system</span>

<span class="mi">3</span><span class="p">.</span> <span class="nx">Learning</span> <span class="nx">Paths</span>
   <span class="o">-</span> <span class="nx">Personalized</span> <span class="nx">curricula</span>
   <span class="o">-</span> <span class="nx">Adaptive</span> <span class="nx">difficulty</span>
   <span class="o">-</span> <span class="nx">Progress</span> <span class="nx">analytics</span>
</code></pre></div></div>

<p><strong>Data Storage:</strong></p>
<ul>
  <li>PostgreSQL: Quiz results, XP points, achievements</li>
  <li>Redis: Active quiz sessions, leaderboards</li>
  <li>Qdrant: Learning pattern embeddings</li>
</ul>

<h3 id="3-project-service-port-3004"><strong>3. Project Service (Port 3004)</strong></h3>
<p><strong>Purpose</strong>: Core project management</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Data Model:</span>
<span class="n">Projects</span> <span class="err">→</span> <span class="n">Epics</span> <span class="err">→</span> <span class="n">Tasks</span> <span class="err">→</span> <span class="n">Subtasks</span>
<span class="n">Teams</span> <span class="err">→</span> <span class="n">Members</span> <span class="err">→</span> <span class="n">Roles</span> <span class="err">→</span> <span class="n">Permissions</span>
<span class="n">Sprints</span> <span class="err">→</span> <span class="n">Velocity</span> <span class="err">→</span> <span class="n">Burndown</span>

<span class="c1">-- Key Operations:</span>
<span class="k">CREATE</span> <span class="n">PROJECT</span> <span class="err">→</span> <span class="n">Generate</span> <span class="n">ID</span> <span class="err">→</span> <span class="k">Set</span> <span class="n">permissions</span>
<span class="k">CREATE</span> <span class="n">TASK</span> <span class="err">→</span> <span class="n">Assign</span> <span class="n">epic</span> <span class="err">→</span> <span class="k">Update</span> <span class="n">status</span>
<span class="n">DRAG</span> <span class="n">TASK</span> <span class="err">→</span> <span class="n">Change</span> <span class="n">status</span> <span class="err">→</span> <span class="n">Broadcast</span> <span class="k">update</span>
</code></pre></div></div>

<p><strong>Real-time Updates:</strong></p>
<ol>
  <li>Task status change → PostgreSQL update</li>
  <li>Trigger WebSocket event</li>
  <li>Broadcast to project room</li>
  <li>All clients update instantly</li>
</ol>

<h3 id="4-ai-gateway-port-3001"><strong>4. AI Gateway (Port 3001)</strong></h3>
<p><strong>Purpose</strong>: LLM orchestration and routing</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Intelligent routing:</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">needsContext</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">context</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">memoryService</span><span class="p">.</span><span class="nx">getRelevant</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">complexity</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">high</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">openai</span><span class="p">.</span><span class="nx">gpt4</span><span class="p">();</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ollama</span><span class="p">.</span><span class="nx">local</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// Features:</span>
<span class="o">-</span> <span class="nx">Prompt</span> <span class="nx">engineering</span>
<span class="o">-</span> <span class="nx">Token</span> <span class="nx">management</span>
<span class="o">-</span> <span class="nx">Model</span> <span class="nx">selection</span>
<span class="o">-</span> <span class="nx">Response</span> <span class="nx">caching</span>
<span class="o">-</span> <span class="nx">Fallback</span> <span class="nx">handling</span>
</code></pre></div></div>

<h3 id="5-api-gateway-port-8080"><strong>5. API Gateway (Port 8080)</strong></h3>
<p><strong>Purpose</strong>: Single entry point for all requests</p>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Routes requests to appropriate services:</span>
<span class="k">/api/auth/*</span>     <span class="s">→</span> <span class="s">Auth</span> <span class="s">Service</span> <span class="s">(3002)</span>
<span class="n">/api/ai/*</span>       <span class="s">→</span> <span class="s">AI</span> <span class="s">Gateway</span> <span class="s">(3001)</span>
<span class="n">/api/memory/*</span>   <span class="s">→</span> <span class="s">Memory</span> <span class="s">Service</span> <span class="s">(3003)</span>
<span class="n">/api/projects/*</span> <span class="s">→</span> <span class="s">Project</span> <span class="s">Service</span> <span class="s">(3004)</span>
<span class="n">/api/learning/*</span> <span class="s">→</span> <span class="s">Learning</span> <span class="s">Engine</span> <span class="s">(8005)</span>

<span class="c1"># Handles:</span>
<span class="s">-</span> <span class="s">Authentication</span> <span class="s">(JWT</span> <span class="s">validation)</span>
<span class="s">-</span> <span class="s">Rate</span> <span class="s">limiting</span> <span class="s">(Redis</span> <span class="s">counters)</span>
<span class="s">-</span> <span class="s">Load</span> <span class="s">balancing</span> <span class="s">(round-robin)</span>
<span class="s">-</span> <span class="s">Response</span> <span class="s">caching</span>
<span class="s">-</span> <span class="s">CORS</span> <span class="s">management</span>
</code></pre></div></div>

<hr />

<h2 id="-how-to-get-everything-working">🚀 How to Get Everything Working</h2>

<h3 id="step-1-start-infrastructure"><strong>Step 1: Start Infrastructure</strong></h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Start databases first</span>
docker-compose up <span class="nt">-d</span> postgres redis qdrant

<span class="c"># Verify they're running</span>
docker ps
curl http://localhost:6333/health  <span class="c"># Qdrant</span>
redis-cli ping                      <span class="c"># Redis</span>
psql <span class="nt">-U</span> devmentor <span class="nt">-d</span> devmentor     <span class="c"># PostgreSQL</span>
</code></pre></div></div>

<h3 id="step-2-start-core-services"><strong>Step 2: Start Core Services</strong></h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Start in this order (dependencies matter!)</span>

<span class="c"># 1. Auth Service (no dependencies)</span>
<span class="nb">cd </span>services/auth-service <span class="o">&amp;&amp;</span> npm start

<span class="c"># 2. Memory Service (needs Qdrant)</span>
<span class="nb">cd </span>services/memory-service <span class="o">&amp;&amp;</span> npm start

<span class="c"># 3. AI Gateway (needs Memory Service)</span>
<span class="nb">cd </span>services/ai-gateway <span class="o">&amp;&amp;</span> npm start

<span class="c"># 4. Project Service (needs PostgreSQL)</span>
<span class="nb">cd </span>services/project-service <span class="o">&amp;&amp;</span> npm start

<span class="c"># 5. Learning Engine (needs all above)</span>
<span class="nb">cd </span>services/learning-engine <span class="o">&amp;&amp;</span> npm start

<span class="c"># 6. API Gateway (needs all services)</span>
<span class="nb">cd </span>services/api-gateway <span class="o">&amp;&amp;</span> npm start

<span class="c"># 7. WebSocket Gateway (needs Redis)</span>
<span class="nb">cd </span>services/websocket-gateway <span class="o">&amp;&amp;</span> npm start
</code></pre></div></div>

<h3 id="step-3-start-frontend"><strong>Step 3: Start Frontend</strong></h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>frontend/devmentor-ui
npm run dev

<span class="c"># Access at http://localhost:3000</span>
</code></pre></div></div>

<hr />

<h2 id="-critical-environment-variables">🔑 Critical Environment Variables</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Database Connections</span>
<span class="nv">POSTGRES_URL</span><span class="o">=</span>postgresql://devmentor:password@localhost:5432/devmentor
<span class="nv">REDIS_URL</span><span class="o">=</span>redis://localhost:6379
<span class="nv">QDRANT_HOST</span><span class="o">=</span>localhost
<span class="nv">QDRANT_PORT</span><span class="o">=</span>6333

<span class="c"># AI Configuration</span>
<span class="nv">OPENAI_API_KEY</span><span class="o">=</span>sk-...  <span class="c"># Required for embeddings</span>
<span class="nv">OLLAMA_URL</span><span class="o">=</span>http://localhost:11434  <span class="c"># Optional local AI</span>

<span class="c"># Service URLs (for inter-service communication)</span>
<span class="nv">AUTH_SERVICE_URL</span><span class="o">=</span>http://localhost:3002
<span class="nv">AI_GATEWAY_URL</span><span class="o">=</span>http://localhost:3001
<span class="nv">MEMORY_SERVICE_URL</span><span class="o">=</span>http://localhost:3003
<span class="nv">PROJECT_SERVICE_URL</span><span class="o">=</span>http://localhost:3004
<span class="nv">LEARNING_ENGINE_URL</span><span class="o">=</span>http://localhost:8005

<span class="c"># Frontend needs</span>
<span class="nv">NEXT_PUBLIC_API_URL</span><span class="o">=</span>http://localhost:8080
<span class="nv">NEXT_PUBLIC_WS_URL</span><span class="o">=</span>ws://localhost:8081
</code></pre></div></div>

<hr />

<h2 id="-performance--scaling">📈 Performance &amp; Scaling</h2>

<h3 id="current-performance-metrics"><strong>Current Performance Metrics</strong></h3>
<ul>
  <li><strong>API Response</strong>: &lt;200ms average</li>
  <li><strong>Vector Search</strong>: &lt;50ms for 10K embeddings</li>
  <li><strong>WebSocket Latency</strong>: &lt;10ms</li>
  <li><strong>Database Queries</strong>: &lt;100ms for complex joins</li>
  <li><strong>Cache Hit Rate</strong>: 85-90%</li>
</ul>

<h3 id="scaling-strategy"><strong>Scaling Strategy</strong></h3>
<ol>
  <li><strong>Horizontal Scaling</strong>: Add more service instances</li>
  <li><strong>Database Sharding</strong>: Partition by project/user</li>
  <li><strong>Cache Layers</strong>: Redis clustering</li>
  <li><strong>CDN</strong>: Static asset delivery</li>
  <li><strong>Load Balancing</strong>: Kubernetes ingress</li>
</ol>

<hr />

<h2 id="-why-this-architecture">🎯 Why This Architecture?</h2>

<h3 id="microservices-benefits"><strong>Microservices Benefits</strong></h3>
<ul>
  <li><strong>Independent Scaling</strong>: Scale only what needs scaling</li>
  <li><strong>Technology Diversity</strong>: Right tool for each job</li>
  <li><strong>Fault Isolation</strong>: One service failure doesn’t crash system</li>
  <li><strong>Team Autonomy</strong>: Teams can work independently</li>
</ul>

<h3 id="multi-database-strategy"><strong>Multi-Database Strategy</strong></h3>
<ul>
  <li><strong>PostgreSQL</strong>: ACID compliance for critical data</li>
  <li><strong>Qdrant</strong>: Optimized for AI/ML workloads</li>
  <li><strong>Redis</strong>: Microsecond latency for real-time</li>
</ul>

<h3 id="event-driven-updates"><strong>Event-Driven Updates</strong></h3>
<ul>
  <li><strong>Real-time Collaboration</strong>: Instant updates across users</li>
  <li><strong>Loose Coupling</strong>: Services communicate via events</li>
  <li><strong>Scalability</strong>: Pub/sub scales naturally</li>
</ul>

<hr />

<h2 id="-current-status--next-steps">🚦 Current Status &amp; Next Steps</h2>

<h3 id="whats-working"><strong>What’s Working</strong></h3>
<p>✅ All core services implemented
✅ Database schemas defined
✅ WebSocket real-time updates
✅ Basic AI integration
✅ Frontend connected</p>

<h3 id="what-needs-work"><strong>What Needs Work</strong></h3>
<p>🟡 Service deployment to Kubernetes
🟡 Production configuration
🟡 Monitoring &amp; observability
🟡 Load testing
🟡 Security hardening</p>

<h3 id="getting-started-checklist"><strong>Getting Started Checklist</strong></h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>□ Install Docker &amp; Docker Compose
□ Set up environment variables
□ Start databases <span class="o">(</span>PostgreSQL, Redis, Qdrant<span class="o">)</span>
□ Run database migrations
□ Start backend services
□ Start frontend
□ Test health endpoints
□ Create first project
□ Test real-time updates
□ Verify AI features
</code></pre></div></div>

<hr />

<h2 id="-key-concepts-summary">📚 Key Concepts Summary</h2>

<ol>
  <li>
    <p><strong>RAG (Retrieval Augmented Generation)</strong>: Combines database search with AI generation for context-aware responses</p>
  </li>
  <li>
    <p><strong>Vector Embeddings</strong>: Text converted to mathematical vectors for semantic similarity search</p>
  </li>
  <li>
    <p><strong>Event Sourcing</strong>: All changes are events that can be replayed</p>
  </li>
  <li>
    <p><strong>CQRS Pattern</strong>: Separate read and write models for optimization</p>
  </li>
  <li>
    <p><strong>Service Mesh</strong>: Services communicate through well-defined APIs</p>
  </li>
  <li>
    <p><strong>WebSocket Rooms</strong>: Isolated real-time channels per project</p>
  </li>
  <li>
    <p><strong>JWT Authentication</strong>: Stateless auth tokens validated at gateway</p>
  </li>
  <li>
    <p><strong>Semantic Search</strong>: Find by meaning rather than exact text match</p>
  </li>
</ol>

<hr />

<p>This is how DevMentor works as a complete system! Each service has a specific purpose, optimal database choice, and clear integration points. The architecture supports real-time collaboration, AI-powered assistance, and scalable growth.</p>



<div style="margin-top: 3rem; padding: 1rem; background: #f6f8fa; border-radius: 5px;">
  <p style="margin: 0; color: #666; font-size: 0.9em;">
    📁 Source: DevMentor / architecture/COMPLETE_DATA_FLOW_ARCHITECTURE.md
  </p>
</div>

  </main>

  <footer>
    <p>&copy; 2024 NatureQuest. Documentation Hub v1.0.0</p>
  </footer>

  <script>
    (function() {
      const html = document.documentElement;
      const buttons = [];
      function setActive(theme) {
        buttons.forEach(b => {
          const active = b.dataset.theme === theme;
          b.classList.toggle('active', active);
          b.setAttribute('aria-pressed', active ? 'true' : 'false');
        });
      }
      function applyTheme(theme) {
        if (theme === 'auto') {
          html.removeAttribute('data-theme');
          localStorage.removeItem('theme');
        } else {
          html.setAttribute('data-theme', theme);
          localStorage.setItem('theme', theme);
        }
        setActive(theme);
      }
      document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.theme-btn').forEach(btn => {
          buttons.push(btn);
          btn.addEventListener('click', () => applyTheme(btn.dataset.theme));
        });
        const saved = localStorage.getItem('theme');
        if (saved === 'light' || saved === 'dark') {
          applyTheme(saved);
        } else {
          applyTheme('auto');
        }
      });
    })();
  </script>
</body>
</html>
