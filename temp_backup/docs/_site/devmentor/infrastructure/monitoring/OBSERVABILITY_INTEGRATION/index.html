<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OBSERVABILITY INTEGRATION | NatureQuest Documentation Hub</title>
  
  <!-- Google Fonts for better readability -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --primary-color: #0969da;
      --text-color: #24292f;
      --text-light: #57606a;
      --bg-light: #f6f8fa;
      --border-color: #d1d9e0;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      font-size: 16px;
      line-height: 1.7;
      color: var(--text-color);
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-feature-settings: "kern" 1, "liga" 1;
    }
    
    /* Typography improvements */
    p {
      margin: 1.25rem 0;
      letter-spacing: -0.011em;
    }
    
    a {
      color: var(--primary-color);
      text-decoration: none;
      transition: all 0.2s ease;
    }
    
    a:hover {
      text-decoration: underline;
      opacity: 0.8;
    }
    
    /* Improved headings */
    h1, h2, h3, h4, h5, h6 {
      font-weight: 600;
      line-height: 1.3;
      margin-top: 2rem;
      margin-bottom: 1rem;
      letter-spacing: -0.02em;
    }
    
    h1 {
      font-size: 2.5rem;
      font-weight: 800;
      color: var(--primary-color);
      margin-top: 0;
      letter-spacing: -0.03em;
    }
    
    h2 {
      font-size: 1.875rem;
      font-weight: 700;
      color: var(--text-color);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.5rem;
    }
    
    h3 {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-color);
    }
    
    h4 {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-color);
    }
    
    /* Lists with better spacing */
    ul, ol {
      padding-left: 1.5rem;
      margin: 1.25rem 0;
    }
    
    li {
      margin: 0.5rem 0;
      line-height: 1.7;
    }
    
    /* Strong text */
    strong, b {
      font-weight: 600;
      color: var(--text-color);
    }
    
    /* Navigation */
    nav {
      background: linear-gradient(135deg, #f6f8fa 0%, #ffffff 100%);
      padding: 1.25rem;
      margin-bottom: 2rem;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    
    nav ul {
      list-style: none;
      padding: 0;
      display: flex;
      gap: 1.5rem;
      flex-wrap: wrap;
      margin: 0;
    }
    
    nav li {
      margin: 0;
    }
    
    nav a {
      color: var(--text-color);
      text-decoration: none;
      font-weight: 500;
      font-size: 0.95rem;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      transition: all 0.2s ease;
    }
    
    nav a:hover {
      background: var(--bg-light);
      color: var(--primary-color);
      text-decoration: none;
      opacity: 1;
    }
    
    /* Code blocks with JetBrains Mono */
    pre {
      background: var(--bg-light);
      padding: 1.25rem;
      border-radius: 8px;
      overflow-x: auto;
      border: 1px solid var(--border-color);
      margin: 1.5rem 0;
      font-size: 0.9rem;
    }
    
    code {
      font-family: 'JetBrains Mono', 'Consolas', 'Monaco', monospace;
      background: var(--bg-light);
      padding: 0.15rem 0.35rem;
      border-radius: 4px;
      font-size: 0.875em;
      font-weight: 500;
    }
    
    pre code {
      background: none;
      padding: 0;
      font-size: 0.875rem;
    }
    
    /* Tables */
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin: 1.5rem 0;
      font-size: 0.95rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      overflow: hidden;
    }
    
    th, td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }
    
    th {
      background: var(--bg-light);
      font-weight: 600;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.025em;
      color: var(--text-light);
    }
    
    tr:last-child td {
      border-bottom: none;
    }
    
    tr:hover {
      background: rgba(246, 248, 250, 0.5);
    }
    
    /* Blockquotes */
    blockquote {
      margin: 1.5rem 0;
      padding: 1rem 1.25rem;
      border-left: 4px solid var(--primary-color);
      background: var(--bg-light);
      border-radius: 0 8px 8px 0;
      font-style: italic;
      color: var(--text-light);
    }
    
    /* Horizontal rules */
    hr {
      border: none;
      height: 1px;
      background: var(--border-color);
      margin: 2rem 0;
    }
    
    /* Main content area */
    main {
      min-height: 60vh;
    }
    
    /* Footer */
    footer {
      margin-top: 4rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border-color);
      color: var(--text-light);
      font-size: 0.875rem;
    }
  </style>
</head>
<body>
  <nav>
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/learning-roadmap/">Learning Roadmap</a></li>
      <li><a href="/all-docs/">All Docs</a></li>
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/learning-roadmap/">Learning Roadmap</a></li>
      
      <li><a href="/devmentor/">DevMentor</a></li>
      
      <li><a href="/quizmentor/">QuizMentor</a></li>
      
      <li><a href="/harvest/">Harvest.ai</a></li>
      
      <li><a href="/naturequest-auth/">Auth</a></li>
      
      <li><a href="/infrastructure/">Infrastructure</a></li>
      
    </ul>
  </nav>

  <main>
    <div class="product-header" style="background: #f6f8fa; padding: 1rem; border-radius: 5px; margin-bottom: 2rem;">
  <span style="color: #666;">DevMentor</span> / 
  <span style="color: #999;">infrastructure/monitoring/OBSERVABILITY_INTEGRATION.md</span>
</div>

<h1>OBSERVABILITY INTEGRATION</h1>


<h1 id="-observability-integration-guide">ğŸ”­ Observability Integration Guide</h1>

<h2 id="overview">Overview</h2>

<p>This document describes how the monitoring service integrates with the broader DevMentor observability ecosystem, including events, metrics, logs, and traces.</p>

<h2 id="the-four-pillars-of-observability">The Four Pillars of Observability</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DEVMENTOR OBSERVABILITY STACK                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   METRICS    â”‚  â”‚     LOGS     â”‚  â”‚   TRACES     â”‚  â”‚ EVENTS â”‚â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚        â”‚â”‚
â”‚  â”‚ Prometheus   â”‚  â”‚   Winston    â”‚  â”‚ OpenTelemetryâ”‚  â”‚WebSocketâ”‚
â”‚  â”‚   Grafana    â”‚  â”‚     ELK      â”‚  â”‚    Jaeger    â”‚  â”‚  Redis â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                 â”‚                 â”‚               â”‚      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                 â”‚                                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                    â”‚  MONITORING SERVICE    â”‚                      â”‚
â”‚                    â”‚   (Aggregation Hub)    â”‚                      â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                 â”‚                                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                    â”‚    UNIFIED DASHBOARD   â”‚                      â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></div>

<h2 id="event-system-integration">Event System Integration</h2>

<h3 id="event-sources-and-consumers">Event Sources and Consumers</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Event flow through the system</span>
<span class="kd">const</span> <span class="nx">eventFlow</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">producers</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">'</span><span class="s1">auth-service</span><span class="dl">'</span><span class="p">,</span>      <span class="c1">// Login/logout events</span>
    <span class="dl">'</span><span class="s1">memory-service</span><span class="dl">'</span><span class="p">,</span>    <span class="c1">// Knowledge updates</span>
    <span class="dl">'</span><span class="s1">ai-gateway</span><span class="dl">'</span><span class="p">,</span>        <span class="c1">// AI decisions</span>
    <span class="dl">'</span><span class="s1">project-service</span><span class="dl">'</span><span class="p">,</span>   <span class="c1">// Project changes</span>
    <span class="dl">'</span><span class="s1">monitoring-service</span><span class="dl">'</span> <span class="c1">// System events</span>
  <span class="p">],</span>
  
  <span class="na">broker</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Redis Pub/Sub</span><span class="dl">'</span><span class="p">,</span>
  
  <span class="na">consumers</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">'</span><span class="s1">monitoring-service</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// Processes all events</span>
    <span class="dl">'</span><span class="s1">frontend-dashboard</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// Real-time updates</span>
    <span class="dl">'</span><span class="s1">notification-service</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// Alerts</span>
    <span class="dl">'</span><span class="s1">audit-service</span><span class="dl">'</span>      <span class="c1">// Compliance logging</span>
  <span class="p">]</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="event-types-and-handlers">Event Types and Handlers</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Core event types from /docs/events/EMITTERS.md</span>
<span class="kd">const</span> <span class="nx">SystemEvents</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// Service Lifecycle</span>
  <span class="dl">'</span><span class="s1">service.started</span><span class="dl">'</span><span class="p">:</span> <span class="nx">handleServiceStart</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">service.stopped</span><span class="dl">'</span><span class="p">:</span> <span class="nx">handleServiceStop</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">service.crashed</span><span class="dl">'</span><span class="p">:</span> <span class="nx">handleServiceCrash</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">service.recovered</span><span class="dl">'</span><span class="p">:</span> <span class="nx">handleServiceRecovery</span><span class="p">,</span>
  
  <span class="c1">// Health Events</span>
  <span class="dl">'</span><span class="s1">health.check.passed</span><span class="dl">'</span><span class="p">:</span> <span class="nx">updateHealthStatus</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">health.check.failed</span><span class="dl">'</span><span class="p">:</span> <span class="nx">triggerHealthAlert</span><span class="p">,</span>
  
  <span class="c1">// Performance Events</span>
  <span class="dl">'</span><span class="s1">performance.threshold.exceeded</span><span class="dl">'</span><span class="p">:</span> <span class="nx">handlePerformanceIssue</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">performance.anomaly.detected</span><span class="dl">'</span><span class="p">:</span> <span class="nx">investigateAnomaly</span><span class="p">,</span>
  
  <span class="c1">// Security Events</span>
  <span class="dl">'</span><span class="s1">security.breach.attempted</span><span class="dl">'</span><span class="p">:</span> <span class="nx">handleSecurityEvent</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">security.audit.completed</span><span class="dl">'</span><span class="p">:</span> <span class="nx">logAuditResult</span><span class="p">,</span>
  
  <span class="c1">// AI Events (from LEARNING.md)</span>
  <span class="dl">'</span><span class="s1">ai.prediction.generated</span><span class="dl">'</span><span class="p">:</span> <span class="nx">processPrediction</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">ai.pattern.detected</span><span class="dl">'</span><span class="p">:</span> <span class="nx">analyzePattern</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">ai.model.updated</span><span class="dl">'</span><span class="p">:</span> <span class="nx">refreshModels</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="websocket-event-broadcasting">WebSocket Event Broadcasting</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// From /docs/events/WEBSOCKET.md integration</span>
<span class="kd">class</span> <span class="nx">EventBroadcaster</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">io</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">io</span> <span class="o">=</span> <span class="nx">io</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">subscriptions</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="c1">// Broadcast to specific rooms</span>
  <span class="nx">broadcastToRoom</span><span class="p">(</span><span class="nx">room</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">io</span><span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="nx">room</span><span class="p">).</span><span class="nx">emit</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">timestamp</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
      <span class="na">source</span><span class="p">:</span> <span class="dl">'</span><span class="s1">monitoring-service</span><span class="dl">'</span><span class="p">,</span>
      <span class="nx">data</span>
    <span class="p">});</span>
  <span class="p">}</span>
  
  <span class="c1">// Broadcast to subscribers</span>
  <span class="nx">broadcastToSubscribers</span><span class="p">(</span><span class="nx">eventType</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">subscribers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">eventType</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="nx">subscribers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">socketId</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">io</span><span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="nx">socketId</span><span class="p">).</span><span class="nx">emit</span><span class="p">(</span><span class="nx">eventType</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
  
  <span class="c1">// Handle subscription management</span>
  <span class="nx">subscribe</span><span class="p">(</span><span class="nx">socketId</span><span class="p">,</span> <span class="nx">eventTypes</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">eventTypes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">type</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">type</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">());</span>
      <span class="p">}</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">type</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="nx">socketId</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="metrics-collection-and-aggregation">Metrics Collection and Aggregation</h2>

<h3 id="prometheus-integration">Prometheus Integration</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># prometheus.yml configuration</span>
<span class="na">global</span><span class="pi">:</span>
  <span class="na">scrape_interval</span><span class="pi">:</span> <span class="s">15s</span>
  <span class="na">evaluation_interval</span><span class="pi">:</span> <span class="s">15s</span>

<span class="na">scrape_configs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">monitoring-service'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">localhost:3006'</span><span class="pi">]</span>
    <span class="na">metrics_path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">/metrics'</span>
    
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">auth-service'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">localhost:3002'</span><span class="pi">]</span>
      
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">memory-service'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">localhost:3003'</span><span class="pi">]</span>
      
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">ai-gateway'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">localhost:3004'</span><span class="pi">]</span>
      
  <span class="pi">-</span> <span class="na">job_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">project-service'</span>
    <span class="na">static_configs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">targets</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">localhost:3005'</span><span class="pi">]</span>
</code></pre></div></div>

<h3 id="custom-metrics">Custom Metrics</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Application-specific metrics</span>
<span class="kd">const</span> <span class="nx">customMetrics</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// Business metrics</span>
  <span class="na">activeUsers</span><span class="p">:</span> <span class="k">new</span> <span class="nx">prometheus</span><span class="p">.</span><span class="nx">Gauge</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">devmentor_active_users</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">help</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Number of active users</span><span class="dl">'</span>
  <span class="p">}),</span>
  
  <span class="na">aiRequestsTotal</span><span class="p">:</span> <span class="k">new</span> <span class="nx">prometheus</span><span class="p">.</span><span class="nx">Counter</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">devmentor_ai_requests_total</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">help</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Total AI requests processed</span><span class="dl">'</span>
  <span class="p">}),</span>
  
  <span class="na">projectsCreated</span><span class="p">:</span> <span class="k">new</span> <span class="nx">prometheus</span><span class="p">.</span><span class="nx">Counter</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">devmentor_projects_created_total</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">help</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Total projects created</span><span class="dl">'</span>
  <span class="p">}),</span>
  
  <span class="c1">// Performance metrics</span>
  <span class="na">apiLatency</span><span class="p">:</span> <span class="k">new</span> <span class="nx">prometheus</span><span class="p">.</span><span class="nx">Histogram</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">devmentor_api_latency_seconds</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">help</span><span class="p">:</span> <span class="dl">'</span><span class="s1">API endpoint latency</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">labelNames</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">method</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">endpoint</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">]</span>
  <span class="p">}),</span>
  
  <span class="c1">// Resource metrics</span>
  <span class="na">memoryUsage</span><span class="p">:</span> <span class="k">new</span> <span class="nx">prometheus</span><span class="p">.</span><span class="nx">Gauge</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">devmentor_memory_usage_bytes</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">help</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Memory usage in bytes</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">labelNames</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">service</span><span class="dl">'</span><span class="p">]</span>
  <span class="p">})</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="logging-architecture">Logging Architecture</h2>

<h3 id="centralized-logging-with-elk-stack">Centralized Logging with ELK Stack</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Winston transport for Elasticsearch</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">ElasticsearchTransport</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">winston-elasticsearch</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">esTransport</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ElasticsearchTransport</span><span class="p">({</span>
  <span class="na">level</span><span class="p">:</span> <span class="dl">'</span><span class="s1">info</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">clientOpts</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">node</span><span class="p">:</span> <span class="dl">'</span><span class="s1">http://localhost:9200</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">auth</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">username</span><span class="p">:</span> <span class="dl">'</span><span class="s1">elastic</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">password</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">ELASTIC_PASSWORD</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">index</span><span class="p">:</span> <span class="dl">'</span><span class="s1">devmentor-logs</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">format</span><span class="p">:</span> <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">combine</span><span class="p">(</span>
    <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">(),</span>
    <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
  <span class="p">)</span>
<span class="p">});</span>

<span class="c1">// Structured logging</span>
<span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="dl">'</span><span class="s1">Service health check</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">service</span><span class="p">:</span> <span class="dl">'</span><span class="s1">auth</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">healthy</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">responseTime</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
  <span class="na">metadata</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">version</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1.0.0</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">environment</span><span class="p">:</span> <span class="dl">'</span><span class="s1">production</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="log-aggregation-pipeline">Log Aggregation Pipeline</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Services â†’ Filebeat â†’ Logstash â†’ Elasticsearch â†’ Kibana
     â†“                    â†“            â†“            â†“
  Log Files           Processing    Storage    Visualization
</code></pre></div></div>

<h3 id="logstash-configuration">Logstash Configuration</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># logstash.conf</span>
<span class="n">input</span> <span class="p">{</span>
  <span class="n">beats</span> <span class="p">{</span>
    <span class="n">port</span> <span class="o">=&gt;</span> <span class="mi">5044</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">filter</span> <span class="p">{</span>
  <span class="n">json</span> <span class="p">{</span>
    <span class="n">source</span> <span class="o">=&gt;</span> <span class="s2">"message"</span>
  <span class="p">}</span>
  
  <span class="n">date</span> <span class="p">{</span>
    <span class="n">match</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">"timestamp"</span><span class="p">,</span> <span class="s2">"ISO8601"</span> <span class="p">]</span>
  <span class="p">}</span>
  
  <span class="n">mutate</span> <span class="p">{</span>
    <span class="n">add_field</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s2">"environment"</span> <span class="o">=&gt;</span> <span class="s2">"${NODE_ENV:development}"</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">if</span> <span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"error"</span> <span class="p">{</span>
    <span class="n">mutate</span> <span class="p">{</span>
      <span class="n">add_tag</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">"alert"</span> <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">output</span> <span class="p">{</span>
  <span class="n">elasticsearch</span> <span class="p">{</span>
    <span class="n">hosts</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"localhost:9200"</span><span class="p">]</span>
    <span class="n">index</span> <span class="o">=&gt;</span> <span class="s2">"devmentor-%{+YYYY.MM.dd}"</span>
  <span class="p">}</span>
  
  <span class="k">if</span> <span class="s2">"alert"</span> <span class="k">in</span> <span class="p">[</span><span class="n">tags</span><span class="p">]</span> <span class="p">{</span>
    <span class="n">email</span> <span class="p">{</span>
      <span class="n">to</span> <span class="o">=&gt;</span> <span class="s2">"ops@devmentor.ai"</span>
      <span class="n">subject</span> <span class="o">=&gt;</span> <span class="s2">"Error Alert: %{service}"</span>
      <span class="n">body</span> <span class="o">=&gt;</span> <span class="s2">"%{message}"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="distributed-tracing">Distributed Tracing</h2>

<h3 id="opentelemetry-integration-future">OpenTelemetry Integration (Future)</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Tracing setup</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">NodeTracerProvider</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@opentelemetry/node</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">Resource</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@opentelemetry/resources</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">SemanticResourceAttributes</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@opentelemetry/semantic-conventions</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">JaegerExporter</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@opentelemetry/exporter-jaeger</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NodeTracerProvider</span><span class="p">({</span>
  <span class="na">resource</span><span class="p">:</span> <span class="k">new</span> <span class="nx">Resource</span><span class="p">({</span>
    <span class="p">[</span><span class="nx">SemanticResourceAttributes</span><span class="p">.</span><span class="nx">SERVICE_NAME</span><span class="p">]:</span> <span class="dl">'</span><span class="s1">monitoring-service</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">[</span><span class="nx">SemanticResourceAttributes</span><span class="p">.</span><span class="nx">SERVICE_VERSION</span><span class="p">]:</span> <span class="dl">'</span><span class="s1">1.0.0</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">}),</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">jaegerExporter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">JaegerExporter</span><span class="p">({</span>
  <span class="na">endpoint</span><span class="p">:</span> <span class="dl">'</span><span class="s1">http://localhost:14268/api/traces</span><span class="dl">'</span><span class="p">,</span>
<span class="p">});</span>

<span class="nx">provider</span><span class="p">.</span><span class="nx">addSpanProcessor</span><span class="p">(</span>
  <span class="k">new</span> <span class="nx">BatchSpanProcessor</span><span class="p">(</span><span class="nx">jaegerExporter</span><span class="p">)</span>
<span class="p">);</span>

<span class="nx">provider</span><span class="p">.</span><span class="nx">register</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="trace-context-propagation">Trace Context Propagation</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Propagate trace context across services</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">trace</span><span class="p">,</span> <span class="nx">propagation</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@opentelemetry/api</span><span class="dl">'</span><span class="p">);</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">makeServiceCall</span><span class="p">(</span><span class="nx">serviceName</span><span class="p">,</span> <span class="nx">endpoint</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">tracer</span> <span class="o">=</span> <span class="nx">trace</span><span class="p">.</span><span class="nx">getTracer</span><span class="p">(</span><span class="dl">'</span><span class="s1">monitoring-service</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">span</span> <span class="o">=</span> <span class="nx">tracer</span><span class="p">.</span><span class="nx">startSpan</span><span class="p">(</span><span class="s2">`call-</span><span class="p">${</span><span class="nx">serviceName</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">propagation</span><span class="p">.</span><span class="nx">inject</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">active</span><span class="p">(),</span> <span class="nx">headers</span><span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="p">{</span> <span class="nx">headers</span> <span class="p">});</span>
    
    <span class="nx">span</span><span class="p">.</span><span class="nx">setAttributes</span><span class="p">({</span>
      <span class="dl">'</span><span class="s1">http.status_code</span><span class="dl">'</span><span class="p">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">http.url</span><span class="dl">'</span><span class="p">:</span> <span class="nx">endpoint</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">service.name</span><span class="dl">'</span><span class="p">:</span> <span class="nx">serviceName</span>
    <span class="p">});</span>
    
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">span</span><span class="p">.</span><span class="nx">recordException</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">span</span><span class="p">.</span><span class="nx">setStatus</span><span class="p">({</span> <span class="na">code</span><span class="p">:</span> <span class="nx">SpanStatusCode</span><span class="p">.</span><span class="nx">ERROR</span> <span class="p">});</span>
    <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
    <span class="nx">span</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="alerting-and-notification-system">Alerting and Notification System</h2>

<h3 id="alert-rules">Alert Rules</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># alerts.yml</span>
<span class="na">groups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">service_alerts</span>
    <span class="na">interval</span><span class="pi">:</span> <span class="s">30s</span>
    <span class="na">rules</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">ServiceDown</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">up == </span><span class="m">0</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">1m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">critical</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Service</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">$labels.job</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">down"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">$labels.job</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">been</span><span class="nv"> </span><span class="s">down</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">more</span><span class="nv"> </span><span class="s">than</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">minute"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighMemoryUsage</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes &gt; </span><span class="m">0.9</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">5m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">memory</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Memory</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">above</span><span class="nv"> </span><span class="s">90%</span><span class="nv"> </span><span class="s">(current:</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">$value</span><span class="nv"> </span><span class="s">}})"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighErrorRate</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">rate(http_requests_total{status=~"5.."}[5m]) &gt; </span><span class="m">0.05</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">5m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">error</span><span class="nv"> </span><span class="s">rate</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Error</span><span class="nv"> </span><span class="s">rate</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">above</span><span class="nv"> </span><span class="s">5%</span><span class="nv"> </span><span class="s">(current:</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">$value</span><span class="nv"> </span><span class="s">}})"</span>
</code></pre></div></div>

<h3 id="notification-channels">Notification Channels</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Multi-channel notification system</span>
<span class="kd">class</span> <span class="nx">NotificationManager</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">channels</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">slack</span><span class="p">:</span> <span class="k">new</span> <span class="nx">SlackNotifier</span><span class="p">(),</span>
      <span class="na">email</span><span class="p">:</span> <span class="k">new</span> <span class="nx">EmailNotifier</span><span class="p">(),</span>
      <span class="na">pagerduty</span><span class="p">:</span> <span class="k">new</span> <span class="nx">PagerDutyNotifier</span><span class="p">(),</span>
      <span class="na">webhook</span><span class="p">:</span> <span class="k">new</span> <span class="nx">WebhookNotifier</span><span class="p">()</span>
    <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="k">async</span> <span class="nx">sendAlert</span><span class="p">(</span><span class="nx">alert</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">channels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getChannelsForSeverity</span><span class="p">(</span><span class="nx">alert</span><span class="p">.</span><span class="nx">severity</span><span class="p">);</span>
    
    <span class="k">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span>
      <span class="nx">channels</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">channel</span> <span class="o">=&gt;</span> 
        <span class="k">this</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">channel</span><span class="p">].</span><span class="nx">send</span><span class="p">(</span><span class="nx">alert</span><span class="p">)</span>
      <span class="p">)</span>
    <span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">getChannelsForSeverity</span><span class="p">(</span><span class="nx">severity</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span><span class="nx">severity</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">critical</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="dl">'</span><span class="s1">slack</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">email</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">pagerduty</span><span class="dl">'</span><span class="p">];</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">high</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="dl">'</span><span class="s1">slack</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">email</span><span class="dl">'</span><span class="p">];</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">medium</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="dl">'</span><span class="s1">slack</span><span class="dl">'</span><span class="p">];</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">low</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="dl">'</span><span class="s1">webhook</span><span class="dl">'</span><span class="p">];</span>
      <span class="nl">default</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="dl">'</span><span class="s1">webhook</span><span class="dl">'</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="dashboard-integration">Dashboard Integration</h2>

<h3 id="grafana-dashboard-configuration">Grafana Dashboard Configuration</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"dashboard"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DevMentor Monitoring Dashboard"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"panels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Service Health Status"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stat"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"up"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"legendFormat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ job }}"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Request Rate"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"graph"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rate(http_requests_total[5m])"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"legendFormat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ method }} {{ route }}"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Error Rate"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"graph"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rate(http_requests_total{status=~</span><span class="se">\"</span><span class="s2">5..</span><span class="se">\"</span><span class="s2">}[5m])"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"legendFormat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ service }}"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Response Time (p95)"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"graph"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"histogram_quantile(0.95, http_request_duration_seconds_bucket)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"legendFormat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ service }}"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="custom-dashboard-api">Custom Dashboard API</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// API for custom dashboard data</span>
<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/api/dashboard/overview</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">services</span><span class="p">:</span> <span class="k">await</span> <span class="nx">getServicesStatus</span><span class="p">(),</span>
    <span class="na">metrics</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">requests</span><span class="p">:</span> <span class="k">await</span> <span class="nx">getTotalRequests</span><span class="p">(),</span>
      <span class="na">errors</span><span class="p">:</span> <span class="k">await</span> <span class="nx">getErrorRate</span><span class="p">(),</span>
      <span class="na">latency</span><span class="p">:</span> <span class="k">await</span> <span class="nx">getAverageLatency</span><span class="p">()</span>
    <span class="p">},</span>
    <span class="na">incidents</span><span class="p">:</span> <span class="k">await</span> <span class="nx">getActiveIncidents</span><span class="p">(),</span>
    <span class="na">predictions</span><span class="p">:</span> <span class="k">await</span> <span class="nx">getLatestPredictions</span><span class="p">(),</span>
    <span class="na">alerts</span><span class="p">:</span> <span class="k">await</span> <span class="nx">getActiveAlerts</span><span class="p">()</span>
  <span class="p">};</span>
  
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="data-retention-and-storage">Data Retention and Storage</h2>

<h3 id="time-series-data-management">Time-Series Data Management</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Data retention policies</span>
<span class="kd">const</span> <span class="nx">retentionPolicies</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">raw</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">resolution</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1s</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">retention</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1h</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">aggregated_5m</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">resolution</span><span class="p">:</span> <span class="dl">'</span><span class="s1">5m</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">retention</span><span class="p">:</span> <span class="dl">'</span><span class="s1">24h</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">aggregated_1h</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">resolution</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1h</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">retention</span><span class="p">:</span> <span class="dl">'</span><span class="s1">7d</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">aggregated_1d</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">resolution</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1d</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">retention</span><span class="p">:</span> <span class="dl">'</span><span class="s1">30d</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Automatic data aggregation</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aggregateMetrics</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">rawData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getMetrics</span><span class="p">(</span><span class="dl">'</span><span class="s1">1s</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">-1h</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="c1">// 5-minute aggregation</span>
  <span class="kd">const</span> <span class="nx">aggregated5m</span> <span class="o">=</span> <span class="nx">aggregate</span><span class="p">(</span><span class="nx">rawData</span><span class="p">,</span> <span class="dl">'</span><span class="s1">5m</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">avg</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">max</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">min</span><span class="dl">'</span><span class="p">]);</span>
  <span class="k">await</span> <span class="nx">storeMetrics</span><span class="p">(</span><span class="nx">aggregated5m</span><span class="p">,</span> <span class="dl">'</span><span class="s1">aggregated_5m</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="c1">// Hourly aggregation</span>
  <span class="kd">const</span> <span class="nx">aggregated1h</span> <span class="o">=</span> <span class="nx">aggregate</span><span class="p">(</span><span class="nx">rawData</span><span class="p">,</span> <span class="dl">'</span><span class="s1">1h</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">avg</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">max</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">min</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">p95</span><span class="dl">'</span><span class="p">]);</span>
  <span class="k">await</span> <span class="nx">storeMetrics</span><span class="p">(</span><span class="nx">aggregated1h</span><span class="p">,</span> <span class="dl">'</span><span class="s1">aggregated_1h</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="c1">// Daily aggregation</span>
  <span class="kd">const</span> <span class="nx">aggregated1d</span> <span class="o">=</span> <span class="nx">aggregate</span><span class="p">(</span><span class="nx">rawData</span><span class="p">,</span> <span class="dl">'</span><span class="s1">1d</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">avg</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">max</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">min</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">p95</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">p99</span><span class="dl">'</span><span class="p">]);</span>
  <span class="k">await</span> <span class="nx">storeMetrics</span><span class="p">(</span><span class="nx">aggregated1d</span><span class="p">,</span> <span class="dl">'</span><span class="s1">aggregated_1d</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="c1">// Clean up old data</span>
  <span class="k">await</span> <span class="nx">cleanupOldData</span><span class="p">(</span><span class="nx">retentionPolicies</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="security-and-compliance">Security and Compliance</h2>

<h3 id="audit-logging">Audit Logging</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Audit trail for compliance</span>
<span class="kd">class</span> <span class="nx">AuditLogger</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">auditEntry</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">timestamp</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
      <span class="na">eventType</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
      <span class="na">userId</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">userId</span><span class="p">,</span>
      <span class="na">service</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">service</span><span class="p">,</span>
      <span class="na">action</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">action</span><span class="p">,</span>
      <span class="na">result</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">result</span><span class="p">,</span>
      <span class="na">metadata</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">metadata</span><span class="p">,</span>
      <span class="na">ipAddress</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">ipAddress</span><span class="p">,</span>
      <span class="na">userAgent</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">userAgent</span>
    <span class="p">};</span>
    
    <span class="c1">// Store in immutable log</span>
    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">writeToImmutableLog</span><span class="p">(</span><span class="nx">auditEntry</span><span class="p">);</span>
    
    <span class="c1">// Send to SIEM if configured</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SIEM_ENABLED</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">sendToSIEM</span><span class="p">(</span><span class="nx">auditEntry</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="data-privacy">Data Privacy</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// PII data masking</span>
<span class="kd">function</span> <span class="nx">maskSensitiveData</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">masked</span> <span class="o">=</span> <span class="p">{</span> <span class="p">...</span><span class="nx">data</span> <span class="p">};</span>
  
  <span class="c1">// Mask email addresses</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">masked</span><span class="p">.</span><span class="nx">email</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">masked</span><span class="p">.</span><span class="nx">email</span> <span class="o">=</span> <span class="nx">masked</span><span class="p">.</span><span class="nx">email</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">(</span><span class="sr">.</span><span class="se">{2})</span><span class="sr">.*</span><span class="se">(</span><span class="sr">@.*</span><span class="se">)</span><span class="sr">/</span><span class="p">,</span> <span class="dl">'</span><span class="s1">$1***$2</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="c1">// Mask API keys</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">masked</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">masked</span><span class="p">.</span><span class="nx">apiKey</span> <span class="o">=</span> <span class="nx">masked</span><span class="p">.</span><span class="nx">apiKey</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">...</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c1">// Remove passwords completely</span>
  <span class="k">delete</span> <span class="nx">masked</span><span class="p">.</span><span class="nx">password</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="nx">masked</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="performance-optimization">Performance Optimization</h2>

<h3 id="metric-sampling">Metric Sampling</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Adaptive sampling based on load</span>
<span class="kd">class</span> <span class="nx">AdaptiveSampler</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sampleRate</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="c1">// Start with 100% sampling</span>
  <span class="p">}</span>
  
  <span class="nx">shouldSample</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">adjustSampleRate</span><span class="p">(</span><span class="nx">load</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">load</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">sampleRate</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">sampleRate</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">load</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">sampleRate</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">sampleRate</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="batch-processing">Batch Processing</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Batch event processing for efficiency</span>
<span class="kd">class</span> <span class="nx">EventBatcher</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">batchSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="nx">flushInterval</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">batch</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">batchSize</span> <span class="o">=</span> <span class="nx">batchSize</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">flushInterval</span> <span class="o">=</span> <span class="nx">flushInterval</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">startFlushTimer</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="nx">add</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">batch</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">batch</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">batchSize</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">flush</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">async</span> <span class="nx">flush</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">batch</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    
    <span class="kd">const</span> <span class="nx">events</span> <span class="o">=</span> <span class="p">[...</span><span class="k">this</span><span class="p">.</span><span class="nx">batch</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">batch</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">processBatch</span><span class="p">(</span><span class="nx">events</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">startFlushTimer</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">flush</span><span class="p">(),</span> <span class="k">this</span><span class="p">.</span><span class="nx">flushInterval</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="integration-testing">Integration Testing</h2>

<h3 id="end-to-end-observability-tests">End-to-End Observability Tests</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Test complete observability pipeline</span>
<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Observability Integration</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">Event flows through entire pipeline</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Generate test event</span>
    <span class="kd">const</span> <span class="nx">testEvent</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">test.event</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">service</span><span class="p">:</span> <span class="dl">'</span><span class="s1">test-service</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="c1">// Emit event</span>
    <span class="k">await</span> <span class="nx">eventEmitter</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="nx">testEvent</span><span class="p">);</span>
    
    <span class="c1">// Verify metric was recorded</span>
    <span class="kd">const</span> <span class="nx">metrics</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getMetrics</span><span class="p">(</span><span class="dl">'</span><span class="s1">test_event_total</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">metrics</span><span class="p">.</span><span class="nx">value</span><span class="p">).</span><span class="nx">toBeGreaterThan</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    
    <span class="c1">// Verify log was created</span>
    <span class="kd">const</span> <span class="nx">logs</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">searchLogs</span><span class="p">({</span> <span class="na">service</span><span class="p">:</span> <span class="dl">'</span><span class="s1">test-service</span><span class="dl">'</span> <span class="p">});</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">logs</span><span class="p">).</span><span class="nx">toContainEqual</span><span class="p">(</span><span class="nx">expect</span><span class="p">.</span><span class="nx">objectContaining</span><span class="p">({</span>
      <span class="na">event_type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">test.event</span><span class="dl">'</span>
    <span class="p">}));</span>
    
    <span class="c1">// Verify trace was created</span>
    <span class="kd">const</span> <span class="nx">traces</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getTraces</span><span class="p">({</span> <span class="na">service</span><span class="p">:</span> <span class="dl">'</span><span class="s1">test-service</span><span class="dl">'</span> <span class="p">});</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">traces</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toBeGreaterThan</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    
    <span class="c1">// Verify dashboard updated</span>
    <span class="kd">const</span> <span class="nx">dashboard</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getDashboardData</span><span class="p">();</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">dashboard</span><span class="p">.</span><span class="nx">events</span><span class="p">).</span><span class="nx">toContainEqual</span><span class="p">(</span>
      <span class="nx">expect</span><span class="p">.</span><span class="nx">objectContaining</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">test.event</span><span class="dl">'</span> <span class="p">})</span>
    <span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="best-practices">Best Practices</h2>

<h3 id="1-structured-data">1. Structured Data</h3>
<ul>
  <li>Use consistent field names across all services</li>
  <li>Include correlation IDs in all events/logs</li>
  <li>Add metadata for context</li>
</ul>

<h3 id="2-performance">2. Performance</h3>
<ul>
  <li>Sample high-volume metrics</li>
  <li>Use batch processing for events</li>
  <li>Implement circuit breakers for external calls</li>
</ul>

<h3 id="3-security">3. Security</h3>
<ul>
  <li>Mask sensitive data</li>
  <li>Use TLS for all connections</li>
  <li>Implement rate limiting</li>
</ul>

<h3 id="4-reliability">4. Reliability</h3>
<ul>
  <li>Implement retry logic with exponential backoff</li>
  <li>Use dead letter queues for failed events</li>
  <li>Have fallback mechanisms</li>
</ul>

<h3 id="5-cost-optimization">5. Cost Optimization</h3>
<ul>
  <li>Implement data retention policies</li>
  <li>Use appropriate storage tiers</li>
  <li>Aggregate old data</li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>The monitoring service serves as the central hub for DevMentorâ€™s observability stack, integrating:</p>
<ul>
  <li><strong>Events</strong> from all services</li>
  <li><strong>Metrics</strong> via Prometheus</li>
  <li><strong>Logs</strong> through Winston/ELK</li>
  <li><strong>Traces</strong> with OpenTelemetry</li>
</ul>

<p>This comprehensive approach ensures complete visibility into system behavior, enabling proactive issue detection and rapid incident response.</p>

<hr />

<p><strong>Related Documentation:</strong></p>
<ul>
  <li><a href="../events/EMITTERS.md">Event System</a></li>
  <li><a href="../events/WEBSOCKET.md">WebSocket Events</a></li>
  <li><a href="../events/LEARNING.md">Learning Events</a></li>
  <li><a href="../operations/DEVMENTOR_OPERATIONS_GUIDE.md">Operations Guide</a></li>
</ul>



<div style="margin-top: 3rem; padding: 1rem; background: #f6f8fa; border-radius: 5px;">
  <p style="margin: 0; color: #666; font-size: 0.9em;">
    ğŸ“ Source: DevMentor / infrastructure/monitoring/OBSERVABILITY_INTEGRATION.md
  </p>
</div>

  </main>

  <footer>
    <p>&copy; 2024 NatureQuest. Documentation Hub v1.0.0</p>
  </footer>
</body>
</html>
